variables:
  UV_CACHE_DIR: .uv-cache

  # GitLab CI creates a separate mountpoint for the build directory,
  # so we need to copy instead of using hard links.
  UV_LINK_MODE: copy

cache:
  - key:
      files:
        - uv.lock
    paths:
      - $UV_CACHE_DIR

default:
  image: ghcr.io/astral-sh/uv:python3.9-bookworm@sha256:055a48a853297bbdaae31a0c30808b14062c5955d2ace518cc0934f3aa63d267
  tags:
    - pangea-internal
  after_script:
    - uv cache prune --ci

stages:
  - lint
  - build
  - unit_tests
  - integration_tests
  - examples
  - publish

include:
  - /examples/.examples-ci.yml
  - /packages/pangea-django/.django-ci.yml
  - /packages/pangea-sdk/.sdk-ci.yml
