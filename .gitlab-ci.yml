variables:
  UV_CACHE_DIR: .uv-cache

  # GitLab CI creates a separate mountpoint for the build directory,
  # so we need to copy instead of using hard links.
  UV_LINK_MODE: copy

cache:
  - key:
      files:
        - uv.lock
    paths:
      - $UV_CACHE_DIR

default:
  image: ghcr.io/astral-sh/uv:python3.9-bookworm-slim@sha256:37165b1a020286468c4508d80d45e6727c3b60161001cd570b5471d9ea6c5e95
  tags:
    - pangea-internal
  after_script:
    - uv cache prune --ci

stages:
  - lint
  - build
  - unit_tests
  - integration_tests
  - examples
  - publish

include:
  - /examples/.examples-ci.yml
  - /packages/pangea-django/.django-ci.yml
  - /packages/pangea-sdk/.sdk-ci.yml
